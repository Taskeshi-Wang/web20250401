<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>搜索最佳行程</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/mycss.css">
    <link rel="stylesheet" href="css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/2.2.2/css/dataTables.dataTables.css" />
    <style>
        body {
            font-family: "Kiwi Maru", serif;
            font-weight: 400;
            font-style: normal;
        }

        .dropdown-content {
            position: fixed;
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }

        .nav-links a:hover {
            background-color: #f10e65;
            border-radius: 5px;
        }

        .white-black-btn {
            background-color: white;
            color: black;
            border: 0px solid;
            padding: 5px 30px;
            border-radius: 10px;
            font-size: 20px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
        }

        .white-black-btn:hover {
            background-color: rgb(80, 3, 80);
            color: white;
        }

        .intro:hover {
            color: rgb(112, 5, 103);
            border: 2px solid;
        }

        .yellow-black-btn {
            background-color: rgb(238, 176, 105);
            color: black;
            border: 0px solid;
            margin: auto;
            width: 150px;
            padding: 5px 20px;
            border-radius: 10px;
            font-size: 20px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
        }

        .intro:hover .yellow-black-btn {
            background-color: rgb(80, 3, 80);
            color: white;
        }

        .btn-purple {
            background-color: #240224;
            color: aliceblue;
            font-size: 20px;
        }

        .btn-purple:hover {
            background-color: #f360f3;
        }

        .slide-btn:hover {
            background-color: #e78d06;
        }

        .carousel-item img {
            display: block;
            margin-left: auto;
            margin-right: auto;
            max-width: 100%;
            height: auto;
        }

        #srh_process {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: linear-gradient(to bottom, #ffffff, #f1f1f1);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.2);
        }

        #srh_process thead {
            background: linear-gradient(135deg, #6a11cb, #2575fc);
            color: white;
            font-weight: bold;
            text-transform: uppercase;
        }

        #srh_process tbody tr:nth-child(odd) {
            background: linear-gradient(135deg, #d4f1ff, #9ed2f5);
        }

        #srh_process tbody tr:nth-child(even) {
            background: linear-gradient(135deg, #9ed2f5, #007bff);
        }

        #srh_process tbody tr:hover {
            background: linear-gradient(135deg, #ff7b00, #ff4800);
            color: white;
            transition: 0.3s ease-in-out;
        }

        #srh_process th {
            text-align: center;
        }

        #srh_process td {
            vertical-align: middle;
        }

        #srh_process button {
            padding: 5px 10px;
            border-radius: 20px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }

        .btn-primary {
            background: linear-gradient(to right, #007bff, #0056b3) !important;
            color: white;
            border: none;
        }

        .btn-secondary {
            background: linear-gradient(to right, #6c757d, #5a6268) !important;
            color: white;
            border: none;
        }

        .btn-danger {
            background: linear-gradient(to right, #dc3545, #b02a37) !important;
            color: white;
            border: none;
        }

        @media screen and (max-width: 768px) {
            table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }
    </style>



</head>

<body>
    <section id="s01" class="py-1 w-100" style="background-color:#b42a64;position: sticky;top: 0;z-index: 10;">
        <div class="container">
            <div class="text-end">
                <a href="#">
                    <i class="fa-brands fa-square-facebook text-primary"></i>
                </a>
                <a href="#">
                    <i class="fa-brands fa-square-x-twitter text-black"></i>
                </a>
                <a href="#">
                    <i class="fa-brands fa-instagram text-danger"></i>
                </a>
                <a href="#">
                    <i class="fa-brands fa-line text-success"></i>
                </a>
            </div>
        </div>
    </section>
    <section id="s02" class="pt-3 w-100" style="background-color: #faf9f9;position: sticky;top:32px;z-index: 10;">
        <div class="container">
            <nav class="navbar navbar-expand-lg" style="background-color: #faf9f9;">
                <div class="container-fluid">
                    <a class="navbar-brand" href="20241226-ex1.html">
                        <img src="images/company_logo.jpg" alt="" style="width: 120px;height: 50px;">
                    </a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav me-auto nav-links" style="white-space: nowrap;">
                            <li class="nav-item fw-1000 fs-4">
                                <a class="nav-link" aria-current="page"
                                    href="20241226-ex1-process_list_panel_v1.html?region=歐洲" data-region="歐洲">歐洲</a>
                            </li>
                            <li class="nav-item fw-1000 fs-4">
                                <a class="nav-link" aria-current="page"
                                    href="20241226-ex1-process_list_panel_v1.html?region=大陸" data-region="大陸">大陸</a>
                            </li>
                            <li class="nav-item fw-1000 fs-4">
                                <a class="nav-link" aria-current="page"
                                    href="20241226-ex1-process_list_panel_v1.html?region=紐澳" data-region="紐澳">紐澳</a>
                            </li>
                            <li class="nav-item fw-1000 fs-4">
                                <a class="nav-link" aria-current="page"
                                    href="20241226-ex1-process_list_panel_v1.html?region=美加" data-region="美加">美加</a>
                            </li>
                            <li class="nav-item fw-1000 fs-4">
                                <a class="nav-link" aria-current="page"
                                    href="20241226-ex1-process_list_panel_v1.html?region=中東" data-region="中東">中東</a>
                            </li>
                            <li class="nav-item fw-1000 fs-4">
                                <a class="nav-link" aria-current="page"
                                    href="20241226-ex1-process_list_panel_v1.html?region=日本" data-region="日本">日本</a>
                            </li>
                            <li class="nav-item fw-1000 fs-4">
                                <a class="nav-link" aria-current="page"
                                    href="20241226-ex1-process_list_panel_v1.html?region=韓國" data-region="韓國">韓國</a>
                            </li>
                            <li class="nav-item fw-1000 fs-4">
                                <a class="nav-link" aria-current="page"
                                    href="20241226-ex1-process_list_panel_v1.html?region=東南亞" data-region="東南亞">東南亞</a>
                            </li>
                            <li class="nav-item fw-1000 fs-4">
                                <a class="nav-link" aria-current="page"
                                    href="20241226-ex1-process_list_panel_v1.html?region=遊輪" data-region="遊輪">豪華遊輪</a>
                            </li>
                        </ul>
                        <div class="dropdown mt-1 me-2">
                            <button class="btn btn-outline-danger dropdown-toggle d-none fs-5 fw-900" type="button"
                                id="s02_manager_panel_btn" data-bs-toggle="dropdown" aria-expanded="false">
                                管理者功能
                            </button>
                            <ul class="dropdown-menu dropdown-content" aria-labelledby="s02_manager_panel_btn">
                                <li><a class="dropdown-item" href="20241226-ex1-member_control_panel_v1.html"
                                        >會員管理</a></li>
                                <li><a class="dropdown-item" href="20241226-ex1-orders_control_panel_v1.html"
                                        >訂單管理</a></li>
                                <li><a class="dropdown-item" href="20241226-ex1-process_control_panel_v1.html?region=歐洲"
                                        >行程管理</a></li>
                                <li><a class="dropdown-item" href="20241226-ex1-report_control_panel_v1.html"
                                        >營業報表</a></li>
                                <li><a class="dropdown-item" href="20241226-ex1-member_edit_panel_v1.html#account"
                                        >帳號管理</a></li>
                                <li><a class="dropdown-item" href="20241226-ex1-member_edit_panel_v1.html#order_query"
                                        >訂單查詢</a></li>
                                <li><a class="dropdown-item" href="https://rate.bot.com.tw/xrt?Lang=zh-tw&redirect=true"
                                        target="_blank">匯率查詢</a></li>
                                <li><a class="dropdown-item" href="https://www.trivago.com.tw/" target="_blank">旅館查詢</a>
                                </li>
                            </ul>
                        </div>
                        <div class="dropdown mt-1 me-2">
                            <button class="btn btn-outline-danger dropdown-toggle d-none fs-5 fw-900" type="button"
                                id="s02_member_panel_btn" data-bs-toggle="dropdown" aria-expanded="false">
                                會員功能
                            </button>
                            <ul class="dropdown-menu dropdown-content" aria-labelledby="s02_member_panel_btn">
                                <li><a class="dropdown-item" href="20241226-ex1-member_edit_panel_v1.html#account"
                                        >帳號管理</a></li>
                                <li><a class="dropdown-item" href="20241226-ex1-member_edit_panel_v1.html#order_query"
                                        >訂單查詢</a></li>
                                <li><a class="dropdown-item" href="https://rate.bot.com.tw/xrt?Lang=zh-tw&redirect=true"
                                        target="_blank">匯率查詢</a></li>
                                <li><a class="dropdown-item" href="https://www.trivago.com.tw/" target="_blank">旅館查詢</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div>
                        <span class="h4 text-success fw-900 me-3 d-none" id="s02_username_showtext"
                            style="white-space: nowrap;">歡迎會員:<span class="h3 text-warning" id="s02_username_text"
                                style="white-space: nowrap;"></span></span>
                    </div>
                    <div>
                        <button class="btn btn-danger d-none" data-bs-toggle="logoutmodal" data-bs-target="#logoutModal"
                            style="white-space: nowrap;" id="s02_logout_btn">登出</button>
                    </div>
                </div>
            </nav>
        </div>
    </section>
    <section id="s12" class="d-none">
        <div class="container border border-2 shadow-lg my-2">
            <div class="row bg-007 fw-900 justify-content-center fs-4 text-bg-danger">搜尋您喜愛的行程</div>
            <div class="row mt-3">
                <div class="mb-3 col-12 col-md-2">
                    <input type="date" class="form-control" id="start_date" name="start_date">
                </div>
                <div class="mb-3 col-12 col-md-2">
                    <input type="date" class="form-control" id="end_date" name="end_date">
                </div>
                <div class="mb-3 col-12 col-md-3">
                    <select name="selectglobalregion" id="selectglobalregion" class="form-select">
                        <option value="" class="text-center" selected disabled>選擇旅遊的地區</option>
                    </select>
                </div>
                <div class="mb-3 col-12 col-md-3">
                    <input type="text" class="form-control" id="process_keyword" name="process_keyword"
                        placeholder="關鍵字:國家或城市">
                </div>
                <div class="mb-3 col-md-2">

                    <button class="col-12 btn text-bg-primary fw-900" type="submit" id="travel_srh_btn">搜尋最佳行程</button>

                </div>
            </div>
        </div>
    </section>
    <section id="s03">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <table id="srh_process" class="shadow-lg mt-5 table-rwd text-center mb-3">
                        <thead>
                            <tr>
                                <th>編號</th>
                                <th>標題</th>
                                <th>內容</th>
                                <th>圖片</th>
                                <th>出發日期</th>
                                <th>返程日期</th>
                                <th>航班</th>
                                <th>團費</th>
                                <th>狀態</th>
                                <th>備註</th>
                            </tr>
                        </thead>
                        <tbody id="mydata">
                            <tr>
                                <td data-th="編號">XX</td>
                                <td data-th="標題">XX</td>
                                <td data-th="內容">XX</td>
                                <td data-th="圖片"><img src="" alt="" class="w-50 border rounded"></td>
                                <td data-th="出發日期">XX</td>
                                <td data-th="返程日期">XX</td>
                                <td data-th="航班">XX</td>
                                <td data-th="團費">XX</td>
                                <td data-th="狀態">XX</td>
                                <td data-th="備註">XX</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>
    <section id="s11">
        <div class="footer_content" style="background-color: #530c6e;color: #e6d4f3;">
            <div class="container">
                <div class="row">
                    <div class="col-lg-7 col-12 left-area">
                        <div class="mb-sm-5 mb-4 wow animate__animated animate__fadeInUp fadeInUp animate__slow"
                            data-wow-delay="0s" style="visibility: visible; animation-name: fadeInUp;">
                            <h1 class="fw-900 mt-5"> <a href="#"
                                    style="text-decoration: none;color:#e6d4f3">綜彩旅行社有限公司</a></h1>
                        </div>
                        <div class="footer-info wow animate__animated animate__fadeInDown animate__slow"
                            data-wow-delay="0s" style="visibility: visible; animation-name: fadeInDown;">
                            <ul class="list-unstyled">
                                <li>統一編號：27560645</li>
                                <li>交觀甲 第6783號 / 品保 北1513</li>
                                <li>負責人：吳佳筠 / 聯絡人：徐信杰</li>
                            </ul>
                            <ul class="list-unstyled">
                                <li>電話：<a href="tel:0225715838" class="d-inline-block">02-2571-5838</a>、<a
                                        href="tel:0225634633" class="d-inline-block">02-2563-4633</a></li>
                                <li>傳真：02-2562-2269</li>
                                <li>地址：104台北市中山區松江路152號６樓603室</li>
                                <li>信箱：<a href="mailto:colorfultravel@yahoo.com.tw">colorfultravel@yahoo.com.tw</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-12 wow animate__animated animate__slideInUp animate__slow" data-wow-delay="0s"
                        style="visibility: visible; animation-name: slideInUp;">
                        <div class="copyrights-info clearfix mt-4">
                            <div class="copyrights d-inline-block mr-3 mb-2">Copyright © 綜彩旅行社有限公司 All Rights Reserved
                            </div>
                            <div class="copyrights d-inline-block">本網站內容享有著作權，禁止侵害，違者必究。</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/jquery-3.7.1.min.js"></script>
    <script src="https://unpkg.com/counterup2@2.0.2/dist/index.js"></script>
    <script src="js/wow.min.js"></script>
    <script src="js/sweetalert2.all.min.js"></script>
    <script src="https://kit.fontawesome.com/176a59b465.js" crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/2.2.2/js/dataTables.js"></script>
    <script type="text/javascript" charset="utf8"
        src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script>

        // 設定輸入框的預設日期
        let today = new Date();
        let yyyy = today.getFullYear();
        let mm = today.getMonth() + 1;
        let dd = today.getDate();
        let futureDate = new Date(today);
        futureDate.setDate(today.getDate() + 7);

        let edd = futureDate.getDate();
        let emm = futureDate.getMonth() + 1;
        let eyyyy = futureDate.getFullYear();

        if (mm < 10) {
            mm = '0' + mm;
        }

        if (dd < 10) {
            dd = '0' + dd;
        }

        if (emm < 10) {
            emm = '0' + emm;
        }

        if (edd < 10) {
            edd = '0' + edd;
        }
       
        document.getElementById("start_date").value = yyyy + '-' + mm + '-' + dd;
        document.getElementById("end_date").value = eyyyy + '-' + emm + '-' + edd;

        window.onload = function () {
            var formData = localStorage.getItem('formData');
            if (formData) {
                var data = JSON.parse(formData);

                $("#mydata").empty();
                var statusBtn = "";
                data.data.forEach(function (item) {

                    let statusBtn = "";
                    let region = encodeURIComponent(item.region); // 假設你有 region 欄位

                    if (item.status === "已成團，報名中") {
                        statusBtn = `<a href="20241226-ex1-process_detail_signup_panel_v1.html?id=${item.id}" target="_blank" class="btn btn-success" style="border-radius: 30px;">${item.status}</a>`;
                    } else if (item.status === "未成團，可報名") {
                        statusBtn = `<a href="20241226-ex1-process_detail_signup_panel_v1.html?id=${item.id}" target="_blank" class="btn btn-warning" style="border-radius: 30px;">${item.status}</a>`;
                    } else if (item.status === "已額滿") {
                        statusBtn = `<a href="#" class="btn btn-secondary" style="border-radius: 30px;">${item.status}</a>`;
                    } else {
                        statusBtn = `<a href="#" class="btn btn-danger" style="border-radius: 30px;">${item.status}</a>`;
                    }

                    var strHTML = `<tr>
                    <td data-th="編號">${item.id}</td>
                    <td data-th="標題">${item.title}</td>
                    <td data-th="內容">${item.content}</td>
                    <td data-th="圖片"><img src="${item.photo}" alt="" class="w-50"></td>
                    <td data-th="出發時間">${item.startdate}</td>
                    <td data-th="返程時間">${item.enddate}</td>
                    <td data-th="航班">${item.airplane}</td>
                    <td data-th="團費">${item.cost}</td>
                    <td data-th="狀態">${statusBtn}</td>
                    <td data-th="備註">${item.remark}</td></tr>`;


                    $("#mydata").append(strHTML);

                });

            } else {
                Swal.fire({
                    title: "查無相關資料",
                    icon: "error"
                });

            }
        };

        var globalcountry;
        var globalcountryhotel;
        var selectedglobalregion;
        var process_keyword;

        $(function () {


            // 確認uid是否合法
            if (getCookie("Uid01")) {

                var JSONdata = {};
                JSONdata["uid01"] = getCookie("Uid01");

                $.ajax({
                    type: "POST",
                    url: "20241226-ex1-member_control_api_v1.php?action=checkuid",
                    data: JSON.stringify(JSONdata),
                    dataType: "json",
                    success: showdata_checkuid,
                    error: function () {
                        Swal.fire({
                            title: "API介接錯誤?",
                            text: "20241226-ex1-member_control_api_v1.php",
                            icon: "error"
                        });
                    }
                });
            } else {
                Swal.fire({
                    title: "請先登入會員",
                    icon: "info",
                    showDenyButton: false,
                    showCancelButton: false,
                    confirmButtonText: "確認",
                    denyButtonText: `Don't save`,
                    allowOutsideClick: false
                }).then((result) => {
                    if (result.isConfirmed) {
                        location.href = "20241226-ex1.html"
                    }
                });
            }

            //s02 logout按紐監聽
            $("#s02_logout_btn").click(function () {
                setCookie("Uid01", "", 7);
                location.href = "20241226-ex1.html";
            });

            // 監聽旅遊地區
            $.ajax({
                type: "GET",
                url: "20241226-ex1-member_control_api_v1.php?action=getregionprocess",
                dataType: "json",
                async: false,
                success: function (data) {
                    data.data.forEach(function (item) {
                        var strHTML = `<option value="${item.region}">${item.region}</option>`;
                        $("#selectglobalregion").append(strHTML);
                    });
                },

                error: function () {
                    console.log("20241226-ex1-member_control_api_v1.php");
                }

            });


            // 按紐監聽 travel_srh_btn 
            $("#travel_srh_btn").click(function () {

                var JSONdata = {};
                JSONdata["startdate"] = $("#start_date").val();
                JSONdata["enddate"] = $("#end_date").val();
                JSONdata["region"] = $("#selectglobalregion").val();
                JSONdata["keyword"] = $("#process_keyword").val();
                $.ajax({
                    type: "POST",
                    url: "20241226-ex1-member_control_api_v1.php?action=getsrhprocess",
                    data: JSON.stringify(JSONdata),
                    dataType: "json",
                    success: showdata_getsrhprocess,
                    error: function () {
                        Swal.fire({
                            title: "API介接錯誤?",
                            text: "20241226-ex1-member_control_api_v1.php",
                            icon: "error"
                        });
                    }
                });

            });
        });


        function showdata_checkuid(data) {
            if (data.state) {
                $("#s02_username_showtext").removeClass("d-none");
                $("#s02_username_text").text(data.data.userName);

                $("#s02_logout_btn").removeClass("d-none");
                $("#s12").removeClass("d-none");
                if (data.data.level != "" && data.data.level === "管理者") {

                    $("#s02_manager_panel_btn").removeClass("d-none");
                } else if (data.data.level != "") {
                    $("#s02_member_panel_btn").removeClass("d-none");
                }

                // 若帳號合法，show srh_result資料
                var JSONdata = {};
                JSONdata["startdate"] = $_POST("#startdate");
                JSONdata["startdate"] = $_POST("#enddate");
                JSONdata["country"] = $_POST("#selectglobalcountry");
                JSONdata["city"] = $_POST("#selectglobalcity");
                $.ajax({
                    type: "POST",
                    url: "20241226-ex1-member_control_api_v1.php?action=getsrhprocess",
                    data: JSON.stringify(JSONdata),
                    dataType: "json",
                    success: showdata_getsrhprocess,
                    error: function () {
                        Swal.fire({
                            title: "API介接錯誤?",
                            text: "20241226-ex1-member_control_api_v1.php",
                            icon: "error"
                        });
                    }
                });

            } else {
                Swal.fire({
                    title: "請先登入會員!",
                    showDenyButton: false,
                    showCancelButton: false,
                    confirmButtonText: "確認",
                    denyButtonText: `Don't save`,
                    allowOutsideClick: false
                }).then((result) => {
                    /* Read more about isConfirmed, isDenied below */
                    if (result.isConfirmed) {
                        location.href = "20241226-ex1.html";
                    }
                });
            }
        }

        function showdata_getsrhprocess(data) {
            $("#mydata").empty();
            var statusBtn = "";
            data.data.forEach(function (item) {
                let statusBtn = "";
                let region = encodeURIComponent(item.region);

                if (item.status === "已成團，報名中") {
                    statusBtn = `<a href="20241226-ex1-process_detail_signup_panel_v1.html?id=${item.id}" target="_blank" class="btn btn-success" style="border-radius: 30px;">${item.status}</a>`;
                } else if (item.status === "未成團，可報名") {
                    statusBtn = `<a href="20241226-ex1-process_detail_signup_panel_v1.html?id=${item.id}" target="_blank" class="btn btn-warning" style="border-radius: 30px;">${item.status}</a>`;
                } else if (item.status === "已額滿") {
                    statusBtn = `<a href="#" class="btn btn-secondary" style="border-radius: 30px;">${item.status}</a>`;
                } else {
                    statusBtn = `<a href="#" class="btn btn-danger" style="border-radius: 30px;">${item.status}</a>`;
                }

                var strHTML = `<tr>
                            <td data-th="編號">${item.id}</td>
                            <td data-th="標題">${item.title}</td>
                            <td data-th="內容">${item.content}</td>
                            <td data-th="圖片"><img src="${item.photo}" alt="" class="w-50"></td>
                            <td data-th="出發時間">${item.startdate}</td>
                            <td data-th="返程時間">${item.enddate}</td>
                            <td data-th="航班">${item.airplane}</td>
                            <td data-th="團費">${item.cost}</td>
                            <td data-th="狀態">${statusBtn}</td>
                            <td data-th="備註">${item.remark}</td>
                        </tr>`;


                $("#mydata").append(strHTML);
            });
        }


        // from w3s Cookie
        function setCookie(cname, cvalue, exdays) {
            const d = new Date();
            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
            let expires = "expires=" + d.toUTCString();
            document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
        }

        function getCookie(cname) {
            let name = cname + "=";
            let ca = document.cookie.split(';');
            for (let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }

    </script>


</body>

</html>